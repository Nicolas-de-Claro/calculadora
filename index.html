<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Herramienta integral para asesores: cotizador, carga de clientes y consultas" />
  <meta name="theme-color" content="#D32F2F" />
  <!-- Content Security Policy -->
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; 
                 script-src 'self' https://cdn.jsdelivr.net https://cdnjs.cloudflare.com; 
                 style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; 
                 font-src https://fonts.gstatic.com; 
                 img-src 'self' data: blob:; 
                 connect-src 'self';">
  <!-- Preload critical resources -->
  <link rel="preload" href="prices.json" as="fetch" crossorigin="anonymous">
  <link rel="preload" href="links.json" as="fetch" crossorigin="anonymous">
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <title>Claro Asesor</title>
  <link rel="manifest" href="manifest.json" />
  <link rel="apple-touch-icon" href="icons/icon-192x192.png" />
  <link rel="icon" type="image/png" href="icons/icon-192x192.png" />
  <link rel="stylesheet" href="styles.css" />
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet" />
</head>

<body>
  <div class="main-container">
    <header class="header" role="banner">
      <h1 id="page-title">Cotizador</h1>
      <div class="header-buttons">
        <button id="theme-toggle-btn" class="theme-toggle-btn" aria-label="Cambiar tema">üåô</button>
        <button id="config-btn" class="config-btn" aria-label="Abrir configuraci√≥n de precios">‚öôÔ∏è</button>
      </div>
    </header>

    <!-- Tab: Calculadora -->
    <main id="tab-calculadora" class="tab-content active" role="tabpanel">
      <div class="carga-section">
        <h2 class="section-title">Cotizador</h2>
        <p class="section-subtitle">Calcula el presupuesto personalizado para tu cliente</p>

        <!-- Card de Internet y TV -->
        <div class="card">
          <h2 class="card-title">Internet y TV</h2>
          <div class="option">
            <label for="baf-type">Tipo de Plan</label>
            <select id="baf-type">
              <option value="RESIDENCIAL">BAF Residencial</option>
              <option value="IP_DINAMICA">BAF IP Din√°mica</option>
              <option value="IP_FIJA">BAF IP Fija</option>
            </select>
          </div>
          <div class="option">
            <label for="internet-speed">Velocidad de Internet</label>
            <select id="internet-speed">
              <option value="no">No incluir</option>
              <option value="100">100 MB</option>
              <option value="300">300 MB</option>
              <option value="600">600 MB</option>
            </select>
          </div>
          <div class="option">
            <label for="add-tv">Servicio de TV</label>
            <select id="add-tv">
              <option value="no">No incluir</option>
              <option value="1">1 Deco</option>
              <option value="2">2 Decos</option>
              <option value="3">3 Decos</option>
            </select>
          </div>
        </div>

        <!-- Secci√≥n de Portabilidad -->
        <div id="portability-section"></div>

        <button id="add-line-btn" class="add-line-btn">+ A√±adir L√≠nea M√≥vil</button>

        <!-- Opciones de Pago -->
        <div class="card">
          <h2 class="card-title">Beneficios</h2>
          <div class="option">
            <label for="has-claro-abono">Descuento Abono Claro</label>
            <select id="has-claro-abono">
              <option value="no">No tiene</option>
              <option value="1">1 L√≠nea</option>
              <option value="2">2 o m√°s</option>
            </select>
          </div>
          <div class="payment-option">
            <label for="pack-futbol-checkbox">A√±adir Pack F√∫tbol</label>
            <label class="toggle-switch">
              <input type="checkbox" id="pack-futbol-checkbox" />
              <span class="slider"></span>
            </label>
          </div>
          <div class="payment-option">
            <label for="claro-pay-checkbox">Pagar con Claro Pay</label>
            <label class="toggle-switch">
              <input type="checkbox" id="claro-pay-checkbox" />
              <span class="slider"></span>
            </label>
          </div>
        </div>

        <!-- Card de Total -->
        <div class="total-card">
          <div id="price-breakdown"></div>
          <hr class="total-separator" style="display: none;" />
          <div class="total-final">
            <h2>Total Mensual</h2>
            <p id="total-price">$0.00</p>
          </div>

          <!-- Action buttons -->
          <div class="action-buttons">
            <button id="copy-summary-btn" class="copy-btn" aria-label="Copiar resumen">üìã Copiar</button>
            <button id="share-summary-btn" class="copy-btn" aria-label="Compartir resumen" style="display: none;">üîó
              Compartir</button>
            <button id="export-pdf-btn" class="copy-btn" aria-label="Exportar a PDF">üìÑ PDF</button>
            <button id="toggle-chart-btn" class="copy-btn" aria-label="Mostrar/ocultar gr√°fico">üìä Gr√°fico</button>
          </div>

          <!-- Chart container (hidden by default) -->
          <div id="chart-container" class="chart-container" style="display: none;">
            <canvas id="cost-chart" aria-label="Gr√°fico de distribuci√≥n de costos"></canvas>
          </div>
        </div>
      </div>
    </main>

    <!-- Tab: Carga de Cliente -->
    <section id="tab-carga" class="tab-content" role="tabpanel" hidden>
      <div class="carga-section">
        <h2 class="section-title">Carga de Cliente</h2>
        <p class="section-subtitle">Selecciona un formulario para cargar un nuevo cliente</p>

        <div id="carga-buttons" class="carga-buttons">
          <!-- Los botones se cargan din√°micamente desde links.json -->
        </div>

        <!-- Formulario Interno: TECCOM ACOMETIMIENTOS -->
        <div id="teccom-form" class="internal-form" style="display: none;">
          <header class="form-header">
            <button id="close-teccom-form" class="back-btn" aria-label="Volver">‚Üê Volver</button>
            <h3 class="form-title">TECCOM ACOMETIMIENTOS</h3>
          </header>

          <div class="form-content">
            <div class="input-group">
              <label for="teccom-admin">Nombre y Apellido Administrador/Encargado</label>
              <input type="text" id="teccom-admin" placeholder="Ej: Juan P√©rez" />
            </div>

            <div class="input-group">
              <label for="teccom-contact">N√∫mero de Contacto</label>
              <input type="tel" id="teccom-contact" placeholder="Ej: 381..." />
            </div>

            <div class="input-group">
              <label for="teccom-time">Franja Horaria</label>
              <input type="text" id="teccom-time" placeholder="Ej: 09:00 - 13:00" />
            </div>

            <div class="input-group">
              <label for="teccom-address">Direcci√≥n Exacta</label>
              <input type="text" id="teccom-address" placeholder="Calle, Altura" />
            </div>

            <div class="row-2-col">
              <div class="input-group">
                <label for="teccom-floors">Cantidad de Pisos</label>
                <input type="number" id="teccom-floors" min="0" />
              </div>
              <div class="input-group">
                <label for="teccom-apts">Dptos por Piso</label>
                <input type="number" id="teccom-apts" min="0" />
              </div>
            </div>

            <div class="input-group">
              <label for="teccom-type">Tipo de Pedido</label>
              <select id="teccom-type">
                <option value="NUEVA ACOMETIDA">Nueva Acometida</option>
                <option value="AMPLIACION">Ampliaci√≥n</option>
                <option value="PROYECTOS ESPECIALES">Proyectos Especiales</option>
              </select>
            </div>

            <div class="form-actions">
              <button id="copy-teccom-btn" class="copy-btn">üìã Copiar Datos</button>
              <button id="share-teccom-btn" class="copy-btn">üîó Compartir</button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Tab: Herramientas -->
    <section id="tab-herramientas" class="tab-content" role="tabpanel" hidden>
      <div class="carga-section">
        <h2 class="section-title">Herramientas</h2>
        <p class="section-subtitle">Utilidades frecuentes para consultas</p>

        <div id="herramientas-buttons" class="carga-buttons">
          <!-- Los botones se cargan din√°micamente desde links.json -->
        </div>
      </div>
    </section>

    <!-- Navigation Tabs (Bottom) -->
    <nav class="tabs-nav" role="tablist">
      <button class="tab-btn active" data-tab="calculadora" role="tab" aria-selected="true">
        üßÆ Calculadora
      </button>
      <button class="tab-btn" data-tab="carga" role="tab" aria-selected="false">
        üìã Carga
      </button>
      <button class="tab-btn" data-tab="herramientas" role="tab" aria-selected="false">
        üîß Herramientas
      </button>
    </nav>

  </div>

  <!-- Modal for configuration -->
  <div id="config-modal" class="modal">
    <div class="modal-content">
      <header class="modal-header">
        <h2>Configuraci√≥n de Precios</h2>
        <span class="close-btn">&times;</span>
      </header>
      <div id="validation-error" style="display: none;"></div>
      <textarea id="json-editor" spellcheck="false"></textarea>
      <div class="modal-actions">
        <button id="format-json-btn" class="secondary-btn">Formatear</button>
        <button id="save-config-btn">Guardar Cambios</button>
      </div>
    </div>
  </div>

  <script type="module" src="script.js"></script>
  <script src="js/sw-register.js"></script>
</body>

</html>